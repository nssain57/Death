<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Runner Game</title>

<style>
body{
  margin:0;
  overflow:hidden;
  background:#f7f7f7;
  font-family:monospace;
}

canvas{
  display:block;
}

#ui{
  position:absolute;
  width:100%;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:#555;
  font-size:22px;
}

#gameOver{
  display:none;
  position:absolute;
  width:100%;
  height:100%;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:#000;
  font-size:40px;
}

#score{
  position:absolute;
  top:20px;
  right:20px;
  font-size:20px;
  letter-spacing:3px;
}
</style>
</head>
<body>

<canvas id="game"></canvas>
<div id="score"></div>

<div id="ui">
  <div style="font-size:50px;">ðŸ¦–</div>
  Tap To Play
</div>

<div id="gameOver">
  GAME OVER
  <div style="font-size:50px;margin-top:20px;">ðŸ”„</div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const ui = document.getElementById("ui");
const gameOverUI = document.getElementById("gameOver");
const scoreText = document.getElementById("score");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize",resize);

let player, obstacles, clouds;
let gravity = 0.8;
let speed = 6;
let score = 0;
let high = localStorage.getItem("high") || 0;
let running = false;

class Player{
  constructor(){
    this.w=40;
    this.h=40;
    this.x=80;
    this.y=canvas.height-this.h-60;
    this.dy=0;
    this.jumpPower=15;
    this.grounded=true;
  }
  draw(){
    ctx.fillStyle="#444";
    ctx.fillRect(this.x,this.y,this.w,this.h);
  }
  update(){
    this.y+=this.dy;
    if(this.y+this.h<canvas.height-60){
      this.dy+=gravity;
      this.grounded=false;
    }else{
      this.dy=0;
      this.grounded=true;
      this.y=canvas.height-this.h-60;
    }
    this.draw();
  }
  jump(){
    if(this.grounded){
      this.dy=-this.jumpPower;
    }
  }
}

class Obstacle{
  constructor(){
    this.w=20+Math.random()*20;
    this.h=40;
    this.x=canvas.width;
    this.y=canvas.height-this.h-60;
  }
  draw(){
    ctx.fillStyle="#333";
    ctx.fillRect(this.x,this.y,this.w,this.h);
  }
  update(){
    this.x-=speed;
    this.draw();
  }
}

class Cloud{
  constructor(){
    this.x=canvas.width;
    this.y=Math.random()*200+20;
    this.size=30;
  }
  draw(){
    ctx.fillStyle="#ccc";
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fill();
  }
  update(){
    this.x-=2;
    this.draw();
  }
}

function init(){
  player=new Player();
  obstacles=[];
  clouds=[];
  speed=6;
  score=0;
}

function spawnObstacle(){
  obstacles.push(new Obstacle());
}

function spawnCloud(){
  clouds.push(new Cloud());
}

function collision(a,b){
  return a.x<b.x+b.w &&
         a.x+a.w>b.x &&
         a.y<b.y+b.h &&
         a.y+a.h>b.y;
}

let frame=0;

function loop(){
  if(!running) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ground
  ctx.fillStyle="#888";
  ctx.fillRect(0,canvas.height-60,canvas.width,2);

  frame++;

  if(frame%90===0) spawnObstacle();
  if(frame%150===0) spawnCloud();

  clouds.forEach((c,i)=>{
    c.update();
    if(c.x<-50) clouds.splice(i,1);
  });

  obstacles.forEach((o,i)=>{
    o.update();
    if(collision(player,o)){
      endGame();
    }
    if(o.x<-50){
      obstacles.splice(i,1);
      score++;
      if(score%10===0) speed+=0.5;
    }
  });

  player.update();

  scoreText.innerText="HI "+high+"  "+score;

  if(score>high){
    high=score;
    localStorage.setItem("high",high);
  }

  requestAnimationFrame(loop);
}

function startGame(){
  ui.style.display="none";
  gameOverUI.style.display="none";
  running=true;
  init();
  loop();
}

function endGame(){
  running=false;
  gameOverUI.style.display="flex";
}

document.addEventListener("click",()=>{
  if(!running) startGame();
  else player.jump();
});
document.addEventListener("keydown",e=>{
  if(e.code==="Space"){
    if(!running) startGame();
    else player.jump();
  }
});
</script>

</body>
</html>
