<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Runner Game</title>

<style>
body{
  margin:0;
  overflow:hidden;
  background:#f7f7f7;
  font-family:Arial;
}

canvas{
  display:block;
}

#scoreBoard{
  position:absolute;
  top:20px;
  right:20px;
  font-size:18px;
}
</style>
</head>
<body>

<canvas id="game"></canvas>
<div id="scoreBoard">Score: 0 | High: 0</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const scoreBoard = document.getElementById("scoreBoard");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

let gravity = 0.8;
let gameSpeed = 6;
let score = 0;
let highScore = localStorage.getItem("highScore") || 0;
let obstacles = [];
let clouds = [];
let frame = 0;
let night = false;

class Player{
  constructor(){
    this.width = 40;
    this.height = 40;
    this.x = 80;
    this.y = canvas.height - this.height - 50;
    this.dy = 0;
    this.jumpForce = 15;
    this.grounded = true;
  }

  draw(){
    ctx.fillStyle = "#000";
    ctx.fillRect(this.x,this.y,this.width,this.height);
  }

  update(){
    this.y += this.dy;

    if(this.y + this.height < canvas.height - 50){
      this.dy += gravity;
      this.grounded = false;
    } else {
      this.dy = 0;
      this.grounded = true;
      this.y = canvas.height - this.height - 50;
    }
    this.draw();
  }

  jump(){
    if(this.grounded){
      this.dy = -this.jumpForce;
    }
  }
}

class Obstacle{
  constructor(type){
    this.width = 20 + Math.random()*20;
    this.height = type === "bird" ? 30 : 40;
    this.x = canvas.width;
    this.y = type === "bird" 
      ? canvas.height - 150 
      : canvas.height - this.height - 50;
  }

  draw(){
    ctx.fillStyle = "#222";
    ctx.fillRect(this.x,this.y,this.width,this.height);
  }

  update(){
    this.x -= gameSpeed;
    this.draw();
  }
}

class Cloud{
  constructor(){
    this.x = canvas.width;
    this.y = Math.random()*200;
    this.size = 30 + Math.random()*20;
  }

  draw(){
    ctx.fillStyle="#ccc";
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fill();
  }

  update(){
    this.x -= 2;
    this.draw();
  }
}

const player = new Player();

function spawnObstacle(){
  const type = Math.random() < 0.7 ? "cactus" : "bird";
  obstacles.push(new Obstacle(type));
}

function spawnCloud(){
  clouds.push(new Cloud());
}

function detectCollision(rect1,rect2){
  return rect1.x < rect2.x + rect2.width &&
         rect1.x + rect1.width > rect2.x &&
         rect1.y < rect2.y + rect2.height &&
         rect1.y + rect1.height > rect2.y;
}

function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Night mode toggle
  if(score > 0 && score % 50 === 0){
    night = !night;
  }

  document.body.style.background = night ? "#111" : "#f7f7f7";
  ctx.fillStyle = night ? "#fff" : "#000";

  frame++;

  if(frame % 90 === 0){
    spawnObstacle();
  }

  if(frame % 150 === 0){
    spawnCloud();
  }

  clouds.forEach((cloud,i)=>{
    cloud.update();
    if(cloud.x < -50) clouds.splice(i,1);
  });

  obstacles.forEach((obs,i)=>{
    obs.update();
    if(detectCollision(player,obs)){
      alert("Game Over! Score: "+score);
      location.reload();
    }
    if(obs.x < -50){
      obstacles.splice(i,1);
      score++;
      if(score % 10 === 0){
        gameSpeed += 0.5;
      }
    }
  });

  player.update();

  scoreBoard.innerText = "Score: "+score+" | High: "+highScore;

  if(score > highScore){
    localStorage.setItem("highScore",score);
  }

  requestAnimationFrame(gameLoop);
}

document.addEventListener("keydown", ()=> player.jump());
document.addEventListener("touchstart", ()=> player.jump());
document.addEventListener("click", ()=> player.jump());

gameLoop();
</script>

</body>
</html>
